USRLIB=${R_PACKAGE_DIR}/usrlib
INCDIR=${R_PACKAGE_DIR}/include
PKG_CPPFLAGS=-I"${INCDIR}"
PKG_LIBS=-L"${USRLIB}" -Wl,-rpath,"${USRLIB}" -lhts -lz -pthread

all: usrlib incdir

libhts.so:
	cd htslib-1.7 && ./configure && $(MAKE)

usrlib: libhts.so
	mkdir -p "${USRLIB}"
	cd htslib-1.7 && cp libhts.so libhts.a "${USRLIB}"
	cd "${USRLIB}" && ln -s libhts.so libhts.so.2

incdir: libhts.so
	mkdir -p "${INCDIR}"
	cp htslib-1.7/htslib/* "${INCDIR}"

clean:
	cd htslib-1.7 && $(MAKE) clean
